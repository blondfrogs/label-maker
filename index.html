<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Label Maker for Addresses</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@^1/index.js"></script>
</head>
<body>
    <div class="container">
        <h1>Free Label Maker for Addresses</h1>
        <p class="subtitle">Generate professional PDF address labels - Works with Avery & compatible brands</p>

        <!-- Paper Size Selector -->
        <div class="region-selector">
            <label>Paper Size:</label>
            <div class="region-toggle">
                <button id="regionUS" class="active" onclick="setRegion('US')">US (Letter)</button>
                <button id="regionUK" onclick="setRegion('UK')">UK/EU (A4)</button>
            </div>
            <span class="region-info" id="regionInfo">Paper: 8.5" √ó 11" (Letter)</span>
        </div>

        <!-- Template Selector -->
        <div class="template-selector">
            <label for="templateSelect">Select Label Template:</label>
            <select id="templateSelect">
                <!-- Options populated by JavaScript based on region -->
            </select>
        </div>

        <!-- Skip Labels Option -->
        <div class="skip-labels-section">
            <label for="skipLabels">Skip Labels:</label>
            <div class="skip-labels-control">
                <input type="number" id="skipLabels" min="0" value="0" placeholder="0">
                <button type="button" class="btn-reset-skip" onclick="resetSkipLabels()" title="Reset to 0">Reset</button>
                <span class="skip-labels-hint" id="skipLabelsHint">Leave blank positions for partially used sheets</span>
            </div>
        </div>

        <!-- Font Selection -->
        <div class="font-selector-row" id="globalFontOptions">
            <label for="globalFontSelect">Font:</label>
            <select id="globalFontSelect" onchange="updateFontFromGlobal()">
                <option value="helvetica">Helvetica (Default)</option>
                <option value="times">Times New Roman</option>
                <option value="courier">Courier (Monospace)</option>
            </select>
            <span id="globalFontPreviewText" class="font-preview-text">This is the font you are selecting.</span>
        </div>

        <!-- Input Method Tabs -->
        <div class="input-tabs">
            <button class="tab-button active" onclick="switchTab('upload')">Upload File</button>
            <button class="tab-button" onclick="switchTab('manual')">Manual Entry</button>
            <button class="tab-button" onclick="switchTab('return')">Return Address</button>
        </div>

        <!-- Upload Section -->
        <div id="uploadSection" class="input-section active">
            <div class="drop-zone" id="dropZone">
                <div class="drop-zone-icon">üìÑ</div>
                <div class="drop-zone-text">Drag & drop your CSV/TSV file here</div>
                <div class="drop-zone-hint">or click to browse</div>
            </div>
            <input type="file" id="fileInput" class="file-input" accept=".csv,.tsv,.txt">

            <div class="format-info">
                <h3>Expected File Format</h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <a href="#" class="download-example" onclick="downloadExampleCSV(); return false;">üì• Download example.csv</a>
                    <a href="#" class="download-example" onclick="downloadExampleExcel(); return false;">üìä Download example.xlsx</a>
                </div>
                <p style="margin-top: 15px;">Your CSV file can use either format:</p>
                <div class="format-example" style="font-size: 11px;" id="formatExample">
                    <!-- Content updated by JavaScript based on region -->
                </div>
                <p style="margin-top: 10px; font-size: 12px; color: #888;">
                    üí° <strong>Tip:</strong> Download the Excel file, edit it with your addresses, then save as CSV to upload here.
                </p>
            </div>

            <!-- Preview Section for File Upload -->
            <div id="previewSection" class="preview-section">
                <div class="preview-header">
                    <h3>Preview Addresses</h3>
                    <div class="preview-stats">
                        <span id="previewCount">0 addresses</span>
                        <span id="previewPages">0 pages</span>
                    </div>
                </div>
                <div id="previewList" class="preview-list"></div>

                <!-- Inline Edit Form for Upload Section -->
                <div id="uploadEditForm" class="manual-entry" style="display: none; margin-top: 15px; border-top: 2px solid #667eea; padding-top: 15px;">
                    <h3 id="uploadFormTitle">Edit Address</h3>
                    <div class="address-form">
                        <div class="form-row name-row">
                            <div class="form-group">
                                <label for="uploadEditTitle">Title</label>
                                <input type="text" id="uploadEditTitle" placeholder="Dr., Mr., Mrs.">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditFirst">First Name *</label>
                                <input type="text" id="uploadEditFirst" placeholder="Jane">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditLast">Last Name *</label>
                                <input type="text" id="uploadEditLast" placeholder="Smith">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditSuffix">Suffix</label>
                                <input type="text" id="uploadEditSuffix" placeholder="Jr., PhD">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="uploadEditAddress1">Address Line 1 *</label>
                            <input type="text" id="uploadEditAddress1" placeholder="123 Main Street">
                        </div>
                        <div class="form-group">
                            <label for="uploadEditAddress2">Address Line 2</label>
                            <input type="text" id="uploadEditAddress2" placeholder="Apt 4B, Suite 100, etc.">
                        </div>
                        <div class="address2-option" id="uploadEditAddress2Option" style="display: none;">
                            <label>
                                <input type="checkbox" id="uploadEditAddress2SameLine">
                                Print Address 2 on same line as Address 1
                            </label>
                            <span class="address2-hint" id="uploadEditAddress2Hint">Per USPS, some addresses require this</span>
                        </div>
                        <div class="form-row four-col">
                            <div class="form-group">
                                <label for="uploadEditCity" id="uploadEditCityLabel">City *</label>
                                <input type="text" id="uploadEditCity" placeholder="New York">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditState" id="uploadEditStateLabel">State *</label>
                                <input type="text" id="uploadEditState" placeholder="NY">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditPostalCode" id="uploadEditPostalLabel">Postal Code *</label>
                                <input type="text" id="uploadEditPostalCode" placeholder="10001">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditCountry">Country</label>
                                <input type="text" id="uploadEditCountry" placeholder="USA">
                            </div>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button id="uploadFormButton" class="btn btn-primary" onclick="saveAddress()">Save Address</button>
                        <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                    </div>
                </div>

                <div id="uploadFullSheetOption" class="full-sheet-option" style="display: none;">
                    <label>
                        <input type="checkbox" id="uploadFullSheetCheckbox" onchange="updateUploadPreviewStats()">
                        Fill entire sheet with the same address
                    </label>
                    <div id="uploadFullSheetHint" class="full-sheet-hint">
                        Creates 30 labels of the same address (based on current template)
                    </div>
                </div>
                <div class="preview-buttons">
                    <button class="btn btn-cancel" onclick="cancelPreview()">Cancel</button>
                    <button class="btn btn-generate" onclick="generateFromPreview()">Generate PDF</button>
                </div>

                <div class="export-csv-section">
                    <div class="export-csv-info">
                        <strong>Export Updated List</strong>
                        <p>Made edits? Export the updated addresses to a CSV file.</p>
                    </div>
                    <button class="export-btn" onclick="exportUploadedAddressesCSV()">
                        Export CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Manual Entry Section -->
        <div id="manualSection" class="input-section">
            <div class="manual-entry">
                <h3 id="manualFormTitle">Add Address</h3>
                <div class="address-form">
                    <!-- Name Row: Title, First, Last, Suffix -->
                    <div class="form-row name-row">
                        <div class="form-group">
                            <label for="manualTitle">Title</label>
                            <input type="text" id="manualTitle" placeholder="Hon.">
                        </div>
                        <div class="form-group">
                            <label for="manualFirst">First Name *</label>
                            <input type="text" id="manualFirst" placeholder="John">
                        </div>
                        <div class="form-group">
                            <label for="manualLast">Last Name *</label>
                            <input type="text" id="manualLast" placeholder="Smith">
                        </div>
                        <div class="form-group">
                            <label for="manualSuffix">Suffix</label>
                            <input type="text" id="manualSuffix" placeholder="Jr.">
                        </div>
                    </div>
                    <!-- Address Row -->
                    <div class="form-group">
                        <label for="manualAddress1">Address Line 1 *</label>
                        <input type="text" id="manualAddress1" placeholder="123 Main St">
                    </div>
                    <div class="form-group">
                        <label for="manualAddress2">Address Line 2</label>
                        <input type="text" id="manualAddress2" placeholder="Apt 4B, Suite 100, etc.">
                    </div>
                    <div class="address2-option" id="address2Option" style="display: none;">
                        <label>
                            <input type="checkbox" id="manualAddress2SameLine">
                            Print Address 2 on same line as Address 1
                        </label>
                        <span class="address2-hint" id="manualAddress2Hint">Per USPS, some addresses require this</span>
                    </div>
                    <!-- City, State, Postal Code, Country Row -->
                    <div class="form-row four-col">
                        <div class="form-group">
                            <label for="manualCity" id="manualCityLabel">City *</label>
                            <input type="text" id="manualCity" placeholder="New York">
                        </div>
                        <div class="form-group">
                            <label for="manualState" id="manualStateLabel">State *</label>
                            <input type="text" id="manualState" placeholder="NY">
                        </div>
                        <div class="form-group">
                            <label for="manualPostalCode" id="manualPostalLabel">Postal Code *</label>
                            <input type="text" id="manualPostalCode" placeholder="10001">
                        </div>
                        <div class="form-group">
                            <label for="manualCountry">Country</label>
                            <input type="text" id="manualCountry" placeholder="USA">
                        </div>
                    </div>
                </div>
                <div class="form-buttons">
                    <button id="manualFormButton" class="btn btn-primary" onclick="saveAddress()">Add Address</button>
                    <button id="manualClearButton" class="btn btn-secondary" onclick="cancelEdit()">Clear</button>
                </div>

                <!-- Addresses List Section (like file upload preview) -->
                <div id="manualAddressesSection" class="preview-section">
                    <div class="preview-header">
                        <h3>Your Addresses</h3>
                        <div class="preview-stats">
                            <span id="manualAddressCount">0 addresses</span>
                            <span id="manualPageCount">0 pages</span>
                        </div>
                    </div>
                    <div id="manualAddressesList" class="preview-list"></div>

                    <div id="manualFullSheetOption" class="full-sheet-option" style="display: none;">
                        <label>
                            <input type="checkbox" id="manualFullSheetCheckbox" onchange="updateManualStats()">
                            Fill entire sheet with the same address
                        </label>
                        <div id="manualFullSheetHint" class="full-sheet-hint">
                            Creates 30 labels of the same address (based on current template)
                        </div>
                    </div>

                    <div class="preview-buttons">
                        <button class="btn btn-cancel" onclick="clearAllAddresses()">Clear All</button>
                        <button class="btn btn-generate" onclick="generateFromManual()">Generate PDF</button>
                    </div>

                    <div class="export-csv-section" style="margin-top: 15px;">
                        <div class="export-csv-info">
                            <strong>Save for Next Time</strong>
                            <p>Export your addresses to a CSV file so you can quickly import them next year instead of typing them again.</p>
                        </div>
                        <button class="export-btn" onclick="exportManualAddressesCSV()">
                            Export CSV
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Return Address Section -->
        <div id="returnSection" class="input-section">
            <div class="return-address-entry">
                <h3>Create Return Address Labels</h3>
                <div class="return-address-info">
                    Fill in your address once and generate a full sheet of identical labels - perfect for return address labels!
                </div>
                <div class="address-form">
                    <!-- Name Row: Title, First, Last, Suffix -->
                    <div class="form-row name-row">
                        <div class="form-group">
                            <label for="returnTitle">Title</label>
                            <input type="text" id="returnTitle" placeholder="The">
                        </div>
                        <div class="form-group">
                            <label for="returnFirst">First Name</label>
                            <input type="text" id="returnFirst" placeholder="(optional)">
                        </div>
                        <div class="form-group">
                            <label for="returnLast">Last Name *</label>
                            <input type="text" id="returnLast" placeholder="Smith Family">
                        </div>
                        <div class="form-group">
                            <label for="returnSuffix">Suffix</label>
                            <input type="text" id="returnSuffix" placeholder="">
                        </div>
                    </div>
                    <!-- Address Row -->
                    <div class="form-group">
                        <label for="returnAddress1">Address Line 1 *</label>
                        <input type="text" id="returnAddress1" placeholder="123 Main St">
                    </div>
                    <div class="form-group">
                        <label for="returnAddress2">Address Line 2</label>
                        <input type="text" id="returnAddress2" placeholder="Apt 4B, Suite 100, etc.">
                    </div>
                    <div class="address2-option" id="returnAddress2Option" style="display: none;">
                        <label>
                            <input type="checkbox" id="returnAddress2SameLine">
                            Print Address 2 on same line as Address 1
                        </label>
                        <span class="address2-hint" id="returnAddress2Hint">Per USPS, some addresses require this</span>
                    </div>
                    <!-- City, State, Postal Code, Country Row -->
                    <div class="form-row four-col">
                        <div class="form-group">
                            <label for="returnCity" id="returnCityLabel">City *</label>
                            <input type="text" id="returnCity" placeholder="New York">
                        </div>
                        <div class="form-group">
                            <label for="returnState" id="returnStateLabel">State *</label>
                            <input type="text" id="returnState" placeholder="NY">
                        </div>
                        <div class="form-group">
                            <label for="returnPostalCode" id="returnPostalLabel">Postal Code *</label>
                            <input type="text" id="returnPostalCode" placeholder="10001">
                        </div>
                        <div class="form-group">
                            <label for="returnCountry">Country</label>
                            <input type="text" id="returnCountry" placeholder="USA">
                        </div>
                    </div>
                </div>

                <!-- Font Selection -->
                <div class="font-selector-row">
                    <label for="fontSelect">Font:</label>
                    <select id="fontSelect" onchange="updateFontFromReturn()">
                        <option value="helvetica">Helvetica (Default)</option>
                        <option value="times">Times New Roman</option>
                        <option value="courier">Courier (Monospace)</option>
                    </select>
                    <span id="fontPreviewText" class="font-preview-text">This is the font you are selecting.</span>
                </div>

                <!-- Icon/Emoji Options (Return Labels Only) -->
                <div class="icon-options-section">
                    <div class="icon-options-header" onclick="toggleIconOptions()">
                        <span class="icon-options-title">Icon & Emoji Options</span>
                        <span class="icon-options-toggle" id="iconOptionsToggle">+</span>
                    </div>
                    <div class="icon-options-content" id="iconOptionsContent" style="display: none;">
                    <p class="icon-options-info">Add a decorative icon or emoji to your return address labels</p>

                    <!-- Icon Selection -->
                    <div class="icon-option-group">
                        <label>Choose Icon:</label>
                        <div class="icon-selector">
                            <div class="icon-option selected" data-icon="none" onclick="selectIcon('none')" title="No icon">
                                <span class="icon-none">None</span>
                            </div>
                            <div class="icon-option" data-icon="gift" onclick="selectIcon('gift')" title="Gift">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 7h-1.1A5.5 5.5 0 0 0 12 2.6 5.5 5.5 0 0 0 5.1 7H4a2 2 0 0 0-2 2v2a1 1 0 0 0 1 1h1v7a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7h1a1 1 0 0 0 1-1V9a2 2 0 0 0-2-2zm-8-2.7a3.5 3.5 0 0 1 3.5 3.2l.1.5H12V4.3zM8.5 7.5A3.5 3.5 0 0 1 12 4.3V8H8.4l.1-.5zM11 19H6v-7h5v7zm0-9H4V9h7v1zm2 9v-7h5v7h-5zm7-9h-7V9h7v1z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="heart" onclick="selectIcon('heart')" title="Heart">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="star" onclick="selectIcon('star')" title="Star">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="snowflake" onclick="selectIcon('snowflake')" title="Snowflake">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M11 1v4.07A8 8 0 0 0 5.07 11H1v2h4.07A8 8 0 0 0 11 18.93V23h2v-4.07A8 8 0 0 0 18.93 13H23v-2h-4.07A8 8 0 0 0 13 5.07V1h-2zm1 6a5 5 0 1 1 0 10 5 5 0 0 1 0-10z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="tree" onclick="selectIcon('tree')" title="Tree">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L4 12h3v4H4l8 6 8-6h-3v-4h3L12 2zm0 3.5L16.5 11H14v4h-4v-4H7.5L12 5.5z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="home" onclick="selectIcon('home')" title="Home">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="mail" onclick="selectIcon('mail')" title="Mail">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                            </div>
                            <div class="icon-option" data-icon="flower" onclick="selectIcon('flower')" title="Flower">
                                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 16a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0-14C9.5 2 8 4.5 8 6c0 1.2.5 2.3 1.3 3A6 6 0 0 0 6 12c0 1.2.3 2.3 1 3.3-.8.7-1.3 1.8-1.3 3 0 2.5 1.5 5 4.3 5 1.5 0 2.7-1 3.3-1.7.6.7 1.8 1.7 3.3 1.7 2.8 0 4.3-2.5 4.3-5 0-1.2-.5-2.3-1.3-3 .7-1 1-2.1 1-3.3a6 6 0 0 0-3.3-5.3c.8-.7 1.3-1.8 1.3-3 0-2.5-1.5-5-4.3-5-1.5 0-2.7 1-3.3 1.7-.6-.7-1.8-1.7-3.3-1.7z"/></svg>
                            </div>
                        </div>
                    </div>

                    <!-- Icon Color -->
                    <div class="icon-option-group" id="iconColorGroup">
                        <label for="iconColor">Icon Color:</label>
                        <div class="color-picker-row">
                            <input type="color" id="iconColor" value="#000000" onchange="setIconColor(this.value)">
                            <div class="color-presets">
                                <button type="button" class="color-preset" style="background: #000000" onclick="setIconColor('#000000'); document.getElementById('iconColor').value='#000000'" title="Black"></button>
                                <button type="button" class="color-preset" style="background: #c41e3a" onclick="setIconColor('#c41e3a'); document.getElementById('iconColor').value='#c41e3a'" title="Christmas Red"></button>
                                <button type="button" class="color-preset" style="background: #165b33" onclick="setIconColor('#165b33'); document.getElementById('iconColor').value='#165b33'" title="Christmas Green"></button>
                                <button type="button" class="color-preset" style="background: #0066b2" onclick="setIconColor('#0066b2'); document.getElementById('iconColor').value='#0066b2'" title="Hanukkah Blue"></button>
                                <button type="button" class="color-preset" style="background: #ffd700" onclick="setIconColor('#ffd700'); document.getElementById('iconColor').value='#ffd700'" title="Gold"></button>
                                <button type="button" class="color-preset" style="background: #667eea" onclick="setIconColor('#667eea'); document.getElementById('iconColor').value='#667eea'" title="Purple"></button>
                            </div>
                        </div>
                    </div>

                    <!-- Emoji Picker -->
                    <div class="icon-option-group">
                        <label>Or Use Emoji:</label>
                        <div class="emoji-picker-wrapper">
                            <div class="emoji-picker-toggle" id="emojiPickerToggle" onclick="toggleEmojiPicker()">
                                <span id="selectedEmojiPreview">Click to select emoji</span>
                                <span class="emoji-picker-arrow">‚ñº</span>
                            </div>
                            <div class="emoji-picker-dropdown" id="emojiPickerDropdown" style="display: none;">
                                <emoji-picker id="emojiPicker"></emoji-picker>
                            </div>
                            <div class="emoji-picker-actions" id="emojiPickerActions" style="display: none;">
                                <span id="selectedEmojiDisplay"></span>
                                <button type="button" class="btn-clear-emoji" onclick="clearEmoji()" title="Clear emoji">Clear</button>
                            </div>
                        </div>
                    </div>

                    <!-- Custom SVG Upload -->
                    <div class="icon-option-group">
                        <label>Custom SVG:</label>
                        <div class="custom-icon-upload">
                            <input type="file" id="customIconInput" accept=".svg" style="display: none;">
                            <button class="btn btn-secondary btn-small" onclick="document.getElementById('customIconInput').click()">Upload SVG</button>
                            <span id="customIconName" class="custom-icon-name"></span>
                            <button id="clearCustomIcon" class="btn-clear-icon" onclick="clearCustomIcon()" style="display: none;">√ó</button>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Live Label Preview -->
                <div class="label-preview-section">
                    <div class="label-preview-header">
                        <h4>Label Preview</h4>
                        <span class="preview-hint">Drag the icon to reposition it</span>
                    </div>
                    <div class="label-preview-container" id="labelPreviewContainer">
                        <div class="label-preview" id="labelPreview">
                            <!-- Snap guide lines -->
                            <div class="snap-line snap-line-h" id="snapLineH"></div>
                            <div class="snap-line snap-line-v" id="snapLineV"></div>

                            <div class="preview-icon" id="previewIcon" draggable="true" style="display: none;">
                                <span id="previewIconContent"></span>
                            </div>
                            <div class="preview-text" id="previewText">
                                <div class="preview-name">Your Name</div>
                                <div class="preview-address">123 Main Street</div>
                                <div class="preview-city">City, State 12345</div>
                            </div>
                        </div>
                    </div>
                    <div class="preview-position-info" id="previewPositionInfo" style="display: none;">
                        <span id="iconPositionInfo">Icon: Not selected</span>
                        <button type="button" class="btn btn-secondary btn-small" onclick="resetIconPosition()">Reset Position</button>
                    </div>
                    <div class="preview-controls" id="previewControls" style="display: none;">
                        <div class="preview-control-row">
                            <label for="iconPosition">Default Position:</label>
                            <select id="iconPosition" onchange="setIconPosition(this.value)">
                                <option value="left">Left of text</option>
                                <option value="right">Right of text</option>
                            </select>
                        </div>
                        <div class="preview-control-row">
                            <label class="switch-label">
                                <span class="switch-text">Snap to center</span>
                                <div class="switch">
                                    <input type="checkbox" id="snapToggle" checked onchange="toggleSnap(this.checked)">
                                    <span class="switch-slider"></span>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-buttons" style="margin-top: 15px;">
                    <button class="btn btn-generate" onclick="generateReturnLabels()" style="flex: 2;">Generate Full Sheet</button>
                    <button class="btn btn-secondary" onclick="clearReturnForm()">Clear</button>
                </div>
                <div id="returnLabelInfo" style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; font-size: 13px; color: #666;">
                    Selected template: <strong id="returnTemplateInfo">Avery 8160 - 30 labels per sheet</strong>
                </div>
            </div>
        </div>

        <div id="status" class="status"></div>

        <!-- Printing Instructions -->
        <div class="instructions">
            <h3>üìã Important Printing Instructions</h3>
            <ul>
                <li><strong>Print Scale:</strong> Set to <strong>100%</strong> or "Actual Size" (NOT "Fit to Page")</li>
                <li><strong>Paper Size:</strong> US Letter (8.5" √ó 11")</li>
                <li><strong>Test First:</strong> Print one page on regular paper and hold it up to the light against your label sheet to check alignment</li>
                <li><strong>No Margins Override:</strong> Use the PDF's built-in margins</li>
            </ul>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-disclaimer">
                <strong>‚ö†Ô∏è DISCLAIMER - USE AT YOUR OWN RISK</strong><br>
                This software is provided "AS IS" without warranty of any kind, express or implied.
                The creators and contributors are not liable for any damages, printing errors, wasted materials,
                or other issues that may arise from using this tool. Always test print on regular paper first
                before using actual label sheets.
            </div>

            <div>
                <strong>Legal Notice:</strong> This is an independent, open-source tool. We are not affiliated with,
                endorsed by, or sponsored by Avery Dennison Corporation or any other label manufacturer.
                "Avery" and related trademarks are the property of their respective owners.
            </div>

            <div class="footer-links">
                <a href="https://github.com/blondfrogs/label-maker" target="_blank">GitHub</a>
                <a href="https://github.com/blondfrogs/label-maker/blob/master/LICENSE" target="_blank">MIT License</a>
                <a href="https://github.com/blondfrogs/label-maker/issues" target="_blank">Report Issue</a>
            </div>

            <div class="footer-copyright">
                ¬© 2025 Free Label Maker | Open Source Project |
                Your privacy is protected - all processing happens in your browser, no data is sent to any server.
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
