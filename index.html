<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Label Maker for Addresses</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Free Label Maker for Addresses</h1>
        <p class="subtitle">Generate professional PDF address labels - Works with Avery & compatible brands</p>

        <!-- Paper Size Selector -->
        <div class="region-selector">
            <label>Paper Size:</label>
            <div class="region-toggle">
                <button id="regionUS" class="active" onclick="setRegion('US')">US (Letter)</button>
                <button id="regionUK" onclick="setRegion('UK')">UK/EU (A4)</button>
            </div>
            <span class="region-info" id="regionInfo">Paper: 8.5" √ó 11" (Letter)</span>
        </div>

        <!-- Template Selector -->
        <div class="template-selector">
            <label for="templateSelect">Select Label Template:</label>
            <select id="templateSelect">
                <!-- Options populated by JavaScript based on region -->
            </select>
        </div>

        <!-- Input Method Tabs -->
        <div class="input-tabs">
            <button class="tab-button active" onclick="switchTab('upload')">Upload File</button>
            <button class="tab-button" onclick="switchTab('manual')">Manual Entry</button>
            <button class="tab-button" onclick="switchTab('return')">Return Address</button>
        </div>

        <!-- Upload Section -->
        <div id="uploadSection" class="input-section active">
            <div class="drop-zone" id="dropZone">
                <div class="drop-zone-icon">üìÑ</div>
                <div class="drop-zone-text">Drag & drop your CSV/TSV file here</div>
                <div class="drop-zone-hint">or click to browse</div>
            </div>
            <input type="file" id="fileInput" class="file-input" accept=".csv,.tsv,.txt">

            <div class="format-info">
                <h3>Expected File Format</h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <a href="#" class="download-example" onclick="downloadExampleCSV(); return false;">üì• Download example.csv</a>
                    <a href="#" class="download-example" onclick="downloadExampleExcel(); return false;">üìä Download example.xlsx</a>
                </div>
                <p style="margin-top: 15px;">Your CSV file can use either format:</p>
                <div class="format-example" style="font-size: 11px;" id="formatExample">
                    <!-- Content updated by JavaScript based on region -->
                </div>
                <p style="margin-top: 10px; font-size: 12px; color: #888;">
                    üí° <strong>Tip:</strong> Download the Excel file, edit it with your addresses, then save as CSV to upload here.
                </p>
            </div>

            <!-- Preview Section for File Upload -->
            <div id="previewSection" class="preview-section">
                <div class="preview-header">
                    <h3>Preview Addresses</h3>
                    <div class="preview-stats">
                        <span id="previewCount">0 addresses</span>
                        <span id="previewPages">0 pages</span>
                    </div>
                </div>
                <div id="previewList" class="preview-list"></div>

                <!-- Inline Edit Form for Upload Section -->
                <div id="uploadEditForm" class="manual-entry" style="display: none; margin-top: 15px; border-top: 2px solid #667eea; padding-top: 15px;">
                    <h3 id="uploadFormTitle">Edit Address</h3>
                    <div class="address-form">
                        <div class="form-row name-row">
                            <div class="form-group">
                                <label for="uploadEditTitle">Title</label>
                                <input type="text" id="uploadEditTitle" placeholder="Dr., Mr., Mrs.">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditFirst">First Name *</label>
                                <input type="text" id="uploadEditFirst" placeholder="Jane">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditLast">Last Name *</label>
                                <input type="text" id="uploadEditLast" placeholder="Smith">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditSuffix">Suffix</label>
                                <input type="text" id="uploadEditSuffix" placeholder="Jr., PhD">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="uploadEditAddress1">Address Line 1 *</label>
                            <input type="text" id="uploadEditAddress1" placeholder="123 Main Street">
                        </div>
                        <div class="form-group">
                            <label for="uploadEditAddress2">Address Line 2</label>
                            <input type="text" id="uploadEditAddress2" placeholder="Apt 4B, Suite 100, etc.">
                        </div>
                        <div class="address2-option" id="uploadEditAddress2Option" style="display: none;">
                            <label>
                                <input type="checkbox" id="uploadEditAddress2SameLine">
                                Print Address 2 on same line as Address 1
                            </label>
                            <span class="address2-hint" id="uploadEditAddress2Hint">Per USPS, some addresses require this</span>
                        </div>
                        <div class="form-row four-col">
                            <div class="form-group">
                                <label for="uploadEditCity" id="uploadEditCityLabel">City *</label>
                                <input type="text" id="uploadEditCity" placeholder="New York">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditState" id="uploadEditStateLabel">State *</label>
                                <input type="text" id="uploadEditState" placeholder="NY">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditPostalCode" id="uploadEditPostalLabel">Postal Code *</label>
                                <input type="text" id="uploadEditPostalCode" placeholder="10001">
                            </div>
                            <div class="form-group">
                                <label for="uploadEditCountry">Country</label>
                                <input type="text" id="uploadEditCountry" placeholder="USA">
                            </div>
                        </div>
                    </div>
                    <div class="form-buttons">
                        <button id="uploadFormButton" class="btn btn-primary" onclick="saveAddress()">Save Address</button>
                        <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                    </div>
                </div>

                <div id="uploadFullSheetOption" class="full-sheet-option" style="display: none;">
                    <label>
                        <input type="checkbox" id="uploadFullSheetCheckbox" onchange="updateUploadPreviewStats()">
                        Fill entire sheet with the same address
                    </label>
                    <div id="uploadFullSheetHint" class="full-sheet-hint">
                        Creates 30 labels of the same address (based on current template)
                    </div>
                </div>
                <div class="preview-buttons">
                    <button class="btn btn-cancel" onclick="cancelPreview()">Cancel</button>
                    <button class="btn btn-generate" onclick="generateFromPreview()">Generate PDF</button>
                </div>

                <div class="export-csv-section">
                    <div class="export-csv-info">
                        <strong>Export Updated List</strong>
                        <p>Made edits? Export the updated addresses to a CSV file.</p>
                    </div>
                    <button class="export-btn" onclick="exportUploadedAddressesCSV()">
                        Export CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Manual Entry Section -->
        <div id="manualSection" class="input-section">
            <div class="manual-entry">
                <h3 id="manualFormTitle">Add Address</h3>
                <div class="address-form">
                    <!-- Name Row: Title, First, Last, Suffix -->
                    <div class="form-row name-row">
                        <div class="form-group">
                            <label for="manualTitle">Title</label>
                            <input type="text" id="manualTitle" placeholder="Hon.">
                        </div>
                        <div class="form-group">
                            <label for="manualFirst">First Name *</label>
                            <input type="text" id="manualFirst" placeholder="John">
                        </div>
                        <div class="form-group">
                            <label for="manualLast">Last Name *</label>
                            <input type="text" id="manualLast" placeholder="Smith">
                        </div>
                        <div class="form-group">
                            <label for="manualSuffix">Suffix</label>
                            <input type="text" id="manualSuffix" placeholder="Jr.">
                        </div>
                    </div>
                    <!-- Address Row -->
                    <div class="form-group">
                        <label for="manualAddress1">Address Line 1 *</label>
                        <input type="text" id="manualAddress1" placeholder="123 Main St">
                    </div>
                    <div class="form-group">
                        <label for="manualAddress2">Address Line 2</label>
                        <input type="text" id="manualAddress2" placeholder="Apt 4B, Suite 100, etc.">
                    </div>
                    <div class="address2-option" id="address2Option" style="display: none;">
                        <label>
                            <input type="checkbox" id="manualAddress2SameLine">
                            Print Address 2 on same line as Address 1
                        </label>
                        <span class="address2-hint" id="manualAddress2Hint">Per USPS, some addresses require this</span>
                    </div>
                    <!-- City, State, Postal Code, Country Row -->
                    <div class="form-row four-col">
                        <div class="form-group">
                            <label for="manualCity" id="manualCityLabel">City *</label>
                            <input type="text" id="manualCity" placeholder="New York">
                        </div>
                        <div class="form-group">
                            <label for="manualState" id="manualStateLabel">State *</label>
                            <input type="text" id="manualState" placeholder="NY">
                        </div>
                        <div class="form-group">
                            <label for="manualPostalCode" id="manualPostalLabel">Postal Code *</label>
                            <input type="text" id="manualPostalCode" placeholder="10001">
                        </div>
                        <div class="form-group">
                            <label for="manualCountry">Country</label>
                            <input type="text" id="manualCountry" placeholder="USA">
                        </div>
                    </div>
                </div>
                <div class="form-buttons">
                    <button id="manualFormButton" class="btn btn-primary" onclick="saveAddress()">Add Address</button>
                    <button id="manualClearButton" class="btn btn-secondary" onclick="cancelEdit()">Clear</button>
                </div>

                <!-- Addresses List Section (like file upload preview) -->
                <div id="manualAddressesSection" class="preview-section">
                    <div class="preview-header">
                        <h3>Your Addresses</h3>
                        <div class="preview-stats">
                            <span id="manualAddressCount">0 addresses</span>
                            <span id="manualPageCount">0 pages</span>
                        </div>
                    </div>
                    <div id="manualAddressesList" class="preview-list"></div>

                    <div id="manualFullSheetOption" class="full-sheet-option" style="display: none;">
                        <label>
                            <input type="checkbox" id="manualFullSheetCheckbox" onchange="updateManualStats()">
                            Fill entire sheet with the same address
                        </label>
                        <div id="manualFullSheetHint" class="full-sheet-hint">
                            Creates 30 labels of the same address (based on current template)
                        </div>
                    </div>

                    <div class="preview-buttons">
                        <button class="btn btn-cancel" onclick="clearAllAddresses()">Clear All</button>
                        <button class="btn btn-generate" onclick="generateFromManual()">Generate PDF</button>
                    </div>

                    <div class="export-csv-section" style="margin-top: 15px;">
                        <div class="export-csv-info">
                            <strong>Save for Next Time</strong>
                            <p>Export your addresses to a CSV file so you can quickly import them next year instead of typing them again.</p>
                        </div>
                        <button class="export-btn" onclick="exportManualAddressesCSV()">
                            Export CSV
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Return Address Section -->
        <div id="returnSection" class="input-section">
            <div class="return-address-entry">
                <h3>Create Return Address Labels</h3>
                <div class="return-address-info">
                    Fill in your address once and generate a full sheet of identical labels - perfect for return address labels!
                </div>
                <div class="address-form">
                    <!-- Name Row: Title, First, Last, Suffix -->
                    <div class="form-row name-row">
                        <div class="form-group">
                            <label for="returnTitle">Title</label>
                            <input type="text" id="returnTitle" placeholder="Hon.">
                        </div>
                        <div class="form-group">
                            <label for="returnFirst">First Name *</label>
                            <input type="text" id="returnFirst" placeholder="John">
                        </div>
                        <div class="form-group">
                            <label for="returnLast">Last Name *</label>
                            <input type="text" id="returnLast" placeholder="Smith">
                        </div>
                        <div class="form-group">
                            <label for="returnSuffix">Suffix</label>
                            <input type="text" id="returnSuffix" placeholder="Jr.">
                        </div>
                    </div>
                    <!-- Address Row -->
                    <div class="form-group">
                        <label for="returnAddress1">Address Line 1 *</label>
                        <input type="text" id="returnAddress1" placeholder="123 Main St">
                    </div>
                    <div class="form-group">
                        <label for="returnAddress2">Address Line 2</label>
                        <input type="text" id="returnAddress2" placeholder="Apt 4B, Suite 100, etc.">
                    </div>
                    <div class="address2-option" id="returnAddress2Option" style="display: none;">
                        <label>
                            <input type="checkbox" id="returnAddress2SameLine">
                            Print Address 2 on same line as Address 1
                        </label>
                        <span class="address2-hint" id="returnAddress2Hint">Per USPS, some addresses require this</span>
                    </div>
                    <!-- City, State, Postal Code, Country Row -->
                    <div class="form-row four-col">
                        <div class="form-group">
                            <label for="returnCity" id="returnCityLabel">City *</label>
                            <input type="text" id="returnCity" placeholder="New York">
                        </div>
                        <div class="form-group">
                            <label for="returnState" id="returnStateLabel">State *</label>
                            <input type="text" id="returnState" placeholder="NY">
                        </div>
                        <div class="form-group">
                            <label for="returnPostalCode" id="returnPostalLabel">Postal Code *</label>
                            <input type="text" id="returnPostalCode" placeholder="10001">
                        </div>
                        <div class="form-group">
                            <label for="returnCountry">Country</label>
                            <input type="text" id="returnCountry" placeholder="USA">
                        </div>
                    </div>
                </div>
                <div class="form-buttons" style="margin-top: 15px;">
                    <button class="btn btn-generate" onclick="generateReturnLabels()" style="flex: 2;">Generate Full Sheet</button>
                    <button class="btn btn-secondary" onclick="clearReturnForm()">Clear</button>
                </div>
                <div id="returnLabelInfo" style="margin-top: 15px; padding: 10px; background: white; border-radius: 6px; font-size: 13px; color: #666;">
                    Selected template: <strong id="returnTemplateInfo">Avery 8160 - 30 labels per sheet</strong>
                </div>
            </div>
        </div>

        <div id="status" class="status"></div>

        <!-- Printing Instructions -->
        <div class="instructions">
            <h3>üìã Important Printing Instructions</h3>
            <ul>
                <li><strong>Print Scale:</strong> Set to <strong>100%</strong> or "Actual Size" (NOT "Fit to Page")</li>
                <li><strong>Paper Size:</strong> US Letter (8.5" √ó 11")</li>
                <li><strong>Test First:</strong> Print one page on regular paper and hold it up to the light against your label sheet to check alignment</li>
                <li><strong>No Margins Override:</strong> Use the PDF's built-in margins</li>
            </ul>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-disclaimer">
                <strong>‚ö†Ô∏è DISCLAIMER - USE AT YOUR OWN RISK</strong><br>
                This software is provided "AS IS" without warranty of any kind, express or implied.
                The creators and contributors are not liable for any damages, printing errors, wasted materials,
                or other issues that may arise from using this tool. Always test print on regular paper first
                before using actual label sheets.
            </div>

            <div>
                <strong>Legal Notice:</strong> This is an independent, open-source tool. We are not affiliated with,
                endorsed by, or sponsored by Avery Dennison Corporation or any other label manufacturer.
                "Avery" and related trademarks are the property of their respective owners.
            </div>

            <div class="footer-links">
                <a href="https://github.com/blondfrogs/label-maker" target="_blank">GitHub</a>
                <a href="https://github.com/blondfrogs/label-maker/blob/master/LICENSE" target="_blank">MIT License</a>
                <a href="https://github.com/blondfrogs/label-maker/issues" target="_blank">Report Issue</a>
            </div>

            <div class="footer-copyright">
                ¬© 2025 Free Label Maker | Open Source Project |
                Your privacy is protected - all processing happens in your browser, no data is sent to any server.
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
